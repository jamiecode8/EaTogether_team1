<header>
	<div class="headerInner">
		<!-- Logo -->
		<a href="./index.html" class="logo">
			<img src="./img/logo.png" alt="" />
		</a>
		<!-- 會員頭像-->
		<div id="header_popups_container" @click="header_toggle" class="header">
			<div class="headerInner_login " id="headerInner_login">
				<a class="headerInner_login_link" >
				</a>
				<!-- 登入後，會員頭像才會出現的彈窗 -->
				<div class="popUps popUpsLogout" id="header_popup" v-show="toggle">
					<!-- <form action="" method="" class="form popUpsLogout_from">
					<a href="./login_member_modify.html">
						<p class="popUpsLogout_p">編輯會員資料</p>
					</a>
					<a href="./login_member.html">
						<p class="popUpsLogout_p">登入/註冊</p>
					</a>
					<a href="./index.html">
						<p class="popUpsLogout_p">登出</p>
					</a>
				</form> -->
				</div>
			</div>
		</div>
		<!-- 漢堡圖 -->
		<div class="ham" id="ham_icon">
			<span class="ham_top"></span>
			<span class="ham_middle"></span>
			<span class="ham_bottom"></span>
		</div>

		<div class="header_overlay" id="header_overlay">
			<nav class="header_overlay_menu">
				<ul>
					<li class="header_list header_inner_logo">
						<a href="./index.html">
						</a>
					</li>
					<li class="header_list header_inner_myUFO">
						<a href="./myUFO.html">
							<span class="header_list_span">我的飛碟</span>
						</a>
					</li>
					<li class="header_list header_inner_myPhoto">
						<a href="./myphoto.html">
							<span class="header_list_span">美食拍立得</span>
						</a>
					</li>
					<li class="header_list header_inner_aboutUs">
						<a href="./story.html">
							<span class="header_list_span">外食故事</span>
						</a>
					</li>
				</ul>
			</nav>
		</div>
	</div>
</header>

<script>
	// 打開漢堡
	$('#ham_icon').click(function () {
		$(this).toggleClass('active');
		$('#header_overlay').toggleClass('open');
	});

	// 滑鼠往下滾，header就會出現底色
	var prevScrollpos = window.pageYOffset;
	window.onscroll = function () {
		var currentScrollPos = window.pageYOffset;
		if (prevScrollpos > currentScrollPos) {
			$('header').css('background', 'transparent')
		} else {
			$('header').css('background', 'rgba(251,255,232,0.5)')
		}
		prevScrollpos = currentScrollPos;
	}

	// 會員登出與修改資料的彈窗
	new Vue({
		el: '.header',
		data: {
			toggle: false,
		},
		methods: {
			header_toggle() {
				this.toggle = !this.toggle;
				this.loginCheck();
			},
			// 登入檢查 
			loginCheck() {
				$.ajax({
					method: "POST",
					url: "./php/Frontend/API/Member_Login_Check.php",
					data: {},
					dataType: "text",
					success: function (response) {
						if (response == "") {
							//尚未登入->前往Login.php
							alert('請先登入，將前往登入頁');
							location.href = 'login_member.html';
						} else {
							
						}
					},
					error: function (exception) {
						alert("數據載入失敗: " + exception.status);
					}
				});
				this.showMember();
			},
			 //顯示會員資訊
			showMember(){
				$.ajax({            
					method: "POST",
					url: "./php/Frontend/API/Member_Login.php",
					data:{},            
					dataType: "text",
					success: function (response) {            
						$("#header_popups_container").append(
								`<div class="headerInner_login header" id="headerInner_login" style="background-image: url('./img/header_story.png');">`
							);
							$("#header_popup").html(
								` <form action="" method="" class="form popUpsLogout_from">
									<a href="./login_member_modify.html">
										<p class="popUpsLogout_p">編輯會員資料</p>
									</a>
									<a href="./index.html">
										<p class="popUpsLogout_p">登出</p>
									</a>
								</form>`
							);
					},
					error: function(exception) {
						alert("數據載入失敗: " + exception.status);
					}
				});
			}  
		},
	});
</script>