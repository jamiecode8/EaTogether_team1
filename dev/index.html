<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />        
        @@include('layout/style.html')
        <title>首頁</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick.css" />
        <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick-theme.css" /> -->
     
    </head>
    <style>
   
    </style>
    <body class="index">
        @@include('layout/header.html')
    
        <div class="wrapper index_wrapper" id="app_index">
            <!-- ----------搜尋按鈕---------- -->
            <ul class="index_searchbtn" id="mySearchBtn">
                <li @click="content=content=='1'?'':'1';isSearchBoard = false" class="search_btn_whatToEat">
                    <!--  ＠click="closeSearchBoard" -->
                    <img src="./img/index/What to eat.png" alt="">
                    <p>今天吃什麼</p>
                </li>
                <li class="search_btn_Search" @click='searchIcon'>
                    <img src="./img/index/search.png" alt="">
                    <p>美食搜尋</p>
                </li>
            </ul>
            <!------------地圖------------>
            <div class="index_map">
                <img class="map_slogan" src="./img/index/slogan.png" alt="">
                <img class="map" src="./img/index/map.png" alt="" />
            </div>
    
    
            <!-- ----------裝飾外星人---------- -->
            <img class="et" src="./img/index/et.png" alt="">
    
            <!-- ----------whatToEat彈窗---------- -->
            <!-- q1 -->
            <keep-alive v-if="content !=='' ">
                <component :is="'popup-'+content" @next-emit="nextQ" @pre-emit="preQ" @answer-emit="answerQ"
                    @get-food-emit="getFoodQ" @close-emit="closeQ" @again-emit="againQ" @store-emit="showStores"
                    :food='whatToEat'>
                </component>
            </keep-alive>

            <!-- 搜尋彈窗 -->
            <div class="popUps index_search_popup" v-show="isSearchBoard">
                <!-- <form class="form getSearch" method="post" action="./php/Frontend/API/search.php"> -->
                <form class="form getSearch">

                    <button type="button" class="getSearchClose btn_close" @click='closeSearch(1)'>
                        <img src="./img/icon/icon_close_20.png" alt="">
                    </button>
                    <h1>Search</h1>
                    <div class="searchFood text_search">
                        <h2>搜尋美食</h2>
                        <input :class="findFoodClass" type="text" :disabled="isTyped" v-model="findFood"
                            @click='showTag(1)'>

                        <img src="./img/icon/icon_search.png" alt="">
                    </div>
                    <div class="searchFood mrt_search">
                        <h2>捷運路線</h2>
                        <input :class="searchLineClass" type="text" disabled="disabled" v-model="searchLine">
                        <img class="mrt_search_icon" src="./img/icon/icon_next_line.png" alt="" @click='showLine'
                            name="searchByLine">
                        <ul class="mrtLines" v-show="isShowLine">
                            <li v-for="line in mrtLine" @click="myline(line)">{{line}}</li>
                        </ul>
                    </div>
                    <div class="searchFood  keyword_search">
                        <h2>標籤搜尋</h2>
                        <input :class="searchTagsClass" type="text" disabled="disabled" v-model="searchTags"
                            name="searchByTag">
                        <img class="keyword_search_icon" src="./img/icon/icon_add_line.png" alt="" @click="showTag(3)">
                    </div>
                    <div class="searchWarn" v-show="isSearchNothing"><img src="./img/index/warn1.png" alt="">
                        <p>Ｏpps!沒有完成搜尋</p>
                    </div>


                    <div class="SearchBtn btn">
                        <input value="出發探索" class="getSearchBtn btn_submit" @click='searchFood()'>
                    </div>

                </form>
            </div>
            <!-- 標籤彈窗     -->
            <div class="popUps tags_popUp" v-show="isShowTag" >
                <form action="#資料傳送送的網址"  class="form getTags">
                    <button type="button" class="getSearchClose btn_close" @click="closeSearch(4)">
                        <img src="./img/icon/icon_close_20.png" alt="">
                    </button>
                    <h2>請選擇標籤</h2>
                    <div class="searchTags">
                        <span v-for="tag in tags" @click="myTag(tag)">{{tag}}</span>
                    </div>
                </form>
            </div>
            <!-- 搜尋結果彈窗 -->
            <div class="popUps index_store_popup" v-show="isSearchStores">
                <form class="form getStore" action="">
                    <button type="button" class="getSearchClose btn_close" @click="closeSearch(2)">
                        <img src="./img/icon/icon_close_20.png" alt="">
                    </button>
                    <div class="searchFood text_search">
                        <h1 class="text_search_title" @click='searchIcon'>搜尋美食</h1>
                        <input type="text" v-model="findFood">
                        <img src="./img/icon/icon_search.png" alt="" @click="searchSomething">
                    </div>
                    <!-- 店家名單 -->
                    <div class="getStoreInf_search">
                        <div class="getStoreInf" @click="finalStoreInf(store)" v-for="store in stores">
                            <ul class="getStoreInf_digital">
                                <li class="getStoreInf_name">
                                    <h2>{{store.store_name}}</h2>
                                </li>
                                        <li class="getStoreInf_star">
                                            <div v-for="star in 4"><img src="./img/icon/icon_star.png" alt=""></div>
                                            <div v-for="darkStar in 1"><img src="./img/icon/icon_star_default.png"
                                                    alt=""></div>
                                        </li>
                                <li class="getStoreInf_station">
                                    <p>捷運站:{{store.station_name}}站</p> <!--  判斷是哪一個站給他該線顏色 -->
                                    <!-- <span class="station_color">{{store.Station}}</span> -->

                                </li>
                                <li class="getStoreInf_tag">
                                    <span>{{store.store_tag1}}</span>
                                    <span>{{store.store_tag2}}</span>
                                    <span>{{store.store_tag3}}</span>


                                </li>
                            </ul>
                            <img class="getStoreInf_pic" :src="[`./img/upload/food/`+store.store_img]" alt="">
                        </div>
                    </div> <!-- 後端要抓全部total筆數 -->
                    <p class="searchTotal">共 <span>{{stores.length}}</span> 筆</p>
                </form>
            </div>
            <!-- 店家詳細資訊 -->
            <div class="popUps index_inf_popup" v-show="isStoreInf">
                <form class="form getStoreDigitalInf" action="">
                    <button type="button" class="getSearchClose btn_close" @click="closeSearch(3)">
                        <img src="./img/icon/icon_close_20.png" alt="">
                    </button>
                    <div class="searchFood text_search">
                        <h1 class="text_search_title">搜尋美食</h1>
                        <input type="text" v-model="findFood">
                        <img src="./img/icon/icon_search.png" alt="" @click="searchSomething">
                    </div>
                    <!-- 店家基本資訊 -->
                    <div class="storeInf" v-if="storeDetail">
                        <div class="storeInf_title">
                            <img class="storeInf_title_like" @click="loginCheck(1)" :style="collectionClass"
                                src="./img/icon/icon_heart.png" alt="">
                            <div>
                                <h2 class="storeInf_title_name">{{storeDetail.store_name}}</h2>
                                <!-- <h2 class="storeInf_title_name">{{store.name}}</h2> -->
                                <div class="getStoreInf_star">
                                    <div v-for="star in 4"><img src="./img/icon/icon_star.png" alt=""></div>
                                    <div v-for="darkStar in 1"><img
                                            src="./img/icon/icon_star_default.png" alt=""></div>
                                    <!-- <div v-for="star in store.star"><img src="./img/icon/icon_star.png" alt=""></div>
                                        <div v-for="darkStar in store.star"><img src="./img/icon/icon_star_default.png" alt=""></div> -->
                                </div>
                                <div class="getStoreInf_tag">
                                    <span>{{storeDetail.store_tag1}}</span>
                                    <span>{{storeDetail.store_tag2}}</span>
                                    <span>{{storeDetail.store_tag3}}</span>

                                </div>
                            </div>
                            <div class="storeInf_title_warn">
                                <img class="storeInf_warnIcon" src="./img/icon/icon_warn.png" alt=""
                                    @click="getStoreReported" :style="signOpacity">
                            </div>
                        </div>
                        <!-- 基本資訊icon     -->
                        <div class="storeInf_section">
                            <ul class="storeInf_sectionIcon">
                                <li class="sectionIcon sectionIcon_location" :class="{'on' : inf === 'location'}"><img
                                        src="./img/icon/icon_location.png" alt="" @click="inf='location'"></li>
                                <li class="sectionIcon sectionIcon_mrt" :class="{'on' : inf === 'station'}"><img
                                        src="./img/icon/icon_mrt.png" alt="" @click="inf='station'"></li>
                                <li class="sectionIcon sectionIcon_tel" :class="{'on' : inf === 'phone'}"><img
                                        src="./img/icon/icon_tel.png" alt="" @click="inf='phone'"></li>
                                <li class="sectionIcon sectionIcon_price" :class="{'on' : inf === 'price'}"><img
                                        src="./img/icon/icon_price.png" alt="" @click="inf='price'"></li>
                            </ul>
                            <component :address='storeDetail.store_address' :station='storeDetail.station_name'
                                :phone='storeDetail.store_tel' :price='storeDetail.price_interval' :is="inf"></component>
                        </div>
                        <!-- 店家照片 -->
                        <div class="storeInf_pic slider">
                            <div class="slider-for">
                                <img :src="[`./img/upload/food/`+storeDetail.food1_img]" alt="">
                                <img :src="[`./img/upload/food/`+storeDetail.food2_img]" alt="">
                                <img :src="[`./img/upload/food/`+storeDetail.food3_img]" alt="">
                                <img :src="[`./img/upload/food/`+storeDetail.menu_img]" alt="">
                            </div>
                            <div class="slider-nav">
                                <img :src="[`./img/upload/food/`+storeDetail.food1_img]" alt="">
                                <img :src="[`./img/upload/food/`+storeDetail.food2_img]" alt="">
                                <img :src="[`./img/upload/food/`+storeDetail.food3_img]" alt="">
                                <img :src="[`./img/upload/food/`+storeDetail.menu_img]" alt="">
                            </div>
                        </div>

                        <!-- <img class="storeInf_picMain" src="./img/index/storeMainPic.jpeg" alt="">
                                <div class="storeInf_picSection"> -->
                        <!-- <img src="./img/index/storePic2.jpeg" alt="">
                                    <img src="./img/index/storePic2.jpeg" alt="">
                                    <img src="./img/index/storePic3.jpeg" alt="">
                                    <img src="./img/index/storePic3.jpeg" alt=""> -->
                        <!-- <img :src="store.image1" alt="">
                                    <img :src="store.image2" alt="">
                                    <img :src="store.image3" alt="">
                                    <img :src="store.image4" alt=""> -->
                        <!-- </div> -->


                        <!-- 評論 -->
                        <div class="storeInf_comment">
                            <h2>評論</h2>
                            <div class="storeInf_comments">
                                <!-- <div class="storeInf_comments" v-for="comment in comments"> -->
                                <ul class="storeInf_commentMain">
                                    <li class="commentMain_account">
                                        <img src="./img/index/account.png" alt="">
                                        <!-- <img :src="store.commentMemberPic" alt=""> -->
                                        <p>場面話魔人</p>
                                        <!-- <p>{{store.commentMember}}</p> -->
                                    </li>

                                    <li class="commentMain_star">
                                        <div v-for="star in 4"><img src="./img/icon/icon_star.png" alt="">
                                        </div>
                                        <div v-for="darkStar in 1"><img
                                                src="./img/icon/icon_star_default.png" alt=""></div>
                                        <!-- <div v-for="star in store.commentStar"><img src="./img/icon/icon_star.png" alt=""></div>
                                            <div v-for="darkStar in 5-store.commentStar"><img src="./img/icon/icon_star_default.png" alt=""></div> -->
                                    </li>

                                    <li class="commentMain_comment">
                                        <p>CP值很棒老闆還幫我打折！</p>
                                        <!-- <p>{{store.comment}}</p> -->
                                    </li>
                                </ul>
                                <ul class="storeInf_commentMain">
                                    <li class="commentMain_account">
                                        <img src="./img/index/account.png" alt="">
                                        <!-- <img :src="store.commentMemberPic" alt=""> -->
                                        <p>挑惕小公主</p>
                                        <!-- <p>{{store.commentMember}}</p> -->
                                    </li>

                                    <li class="commentMain_star">
                                        <div v-for="star in 2"><img src="./img/icon/icon_star.png" alt="">
                                        </div>
                                        <div v-for="darkStar in 3"><img
                                                src="./img/icon/icon_star_default.png" alt=""></div>
                                        <!-- <div v-for="star in store.commentStar"><img src="./img/icon/icon_star.png" alt=""></div>
                                            <div v-for="darkStar in 5-store.commentStar"><img src="./img/icon/icon_star_default.png" alt=""></div> -->
                                    </li>

                                    <li class="commentMain_comment">
                                        <p>沒有金湯匙我不接受</p>
                                        <!-- <p>{{store.comment}}</p> -->
                                    </li>
                                </ul>
                                <ul class="storeInf_commentMain">
                                    <li class="commentMain_account">
                                        <img src="./img/index/account.png" alt="">
                                        <!-- <img :src="store.commentMemberPic" alt=""> -->
                                        <p>信義小辣椒</p>
                                        <!-- <p>{{store.commentMember}}</p> -->
                                    </li>

                                    <li class="commentMain_star">
                                        <div v-for="star in 5"><img src="./img/icon/icon_star.png" alt="">
                                        </div>
                                        <div v-for="darkStar in 0"><img
                                                src="./img/icon/icon_star_default.png" alt=""></div>
                                        <!-- <div v-for="star in store.commentStar"><img src="./img/icon/icon_star.png" alt=""></div>
                                            <div v-for="darkStar in 5-store.commentStar"><img src="./img/icon/icon_star_default.png" alt=""></div> -->
                                    </li>

                                    <li class="commentMain_comment">
                                        <p>抓住我的胃了</p>
                                        <!-- <p>{{store.comment}}</p> -->
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <!-- 優惠券 -->
                    <div class="btn storeInf_btn">
                        <input v-model="coupon" class="getCouponBtn btn_submit" @click="loginCheck(2)" />
                    </div>
                    <br />
                </form>
            </div>
            <!-- 檢舉店家彈窗 -->
            <div class="popUps index_searcReport_popup" v-show="isSearchReport">
                <form class="form getReport" action="">
                    <button type="button" class="getReportClose btn_close" @click="closeSearch(5)">
                        <img src="./img/icon/icon_close_20.png" alt="">
                    </button>
                    <h1>我要檢舉</h1>
                    <div class="reportReason">
                        <img src="./img/index/warn2.png" alt="">
                        <h2>檢舉原因:</h2>
                        <textarea class="reportReason_text" name="" id="" cols="30" rows="5" v-model="report"
                            placeholder="請留下原因 管理員會盡快處理！"></textarea>
                    </div>
                    <div class="reportBtn btn">
                        <input @click='sendReport' value="檢舉" class="getReportBtn btn_submit" />
                    </div>

                </form>
            </div>
        </div>
        @@include('layout/footer.html')
        <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick.js"></script>        
        <script>
            const bus = new Vue();
            Vue.component('popup-1', {
                props: [''],
                template: `
                    <div class="popUps index_whatToEat_popup 1">
                        <form class="form whatToEat_q" action="">
                            <button type="button" class="whatToEatClose btn_close">
                                <img src="./img/icon/icon_close_20.png" alt="" @click='closeForm'>
                            </button>
                            <h1>今天吃什麼</h1>
                            <h2>Q1:請選擇符合你心情的顏色</h2>
                            <input  @click="showList" type="text" class="myOptions" v-model="selectedOption">
                            <img class="whatToEat_q_arrow" @click="showList" src="./img/icon/icon_next_line.png" alt="">
                                <ul v-show="isOption" class="select_options" id="options">
                                    <li v-for="color in mrtColor" @click="getOption(color)">{{color}}</li>
                                </ul>
                                <div v-show="warn" class="questionWarn">
                                    <img src="./img/index/warn.png" alt="">
                                    <p> 請完成作答</p>
                                </div>
                            <div class="btn">
                                <input  value="下一題" class="whatBtnNext btn_submit" @click="getNext" />
                            </div>
                            
                        </form>
                    </div>
                `,
                data() {
                    return {
                        selectedOption: '',
                        mrtColor: ['藍色', '紅色', '綠色', '棕色', '黃色'],
                        isOption: false,
                        warn: false,
                    };
                },
                mounted() {
                    bus.$on('clear-input-emit', () => this.selectedOption = '');
                },
                methods: {
                    showList() {
                        this.isOption = !this.isOption;
                    },
                    getOption(color) {
                        this.selectedOption = color;
                        this.isOption = false;
                        this.$emit('answer-emit', color);
                        this.warn = false;
                    },
                    getNext() {
                        //  判斷有沒有值可進到下一題
                        if (this.selectedOption !== '') {
                            this.$emit('next-emit');
                        } else {
                            this.warn = true;
                        }
                    },
                    closeForm() {
                        this.$emit('close-emit');
                        bus.$emit('clear-input-emit')
                        this.warn = false;
                    },
    
                },
            });
            Vue.component('popup-2', {
                props: [''],
                template: `
                    <div class="popUps index_whatToEat_popup 2">
                        <form class="form whatToEat_q" action="">
                            <button type="button" class="whatToEatClose btn_close">
                                <img src="./img/icon/icon_close_20.png" alt="" @click='closeForm'>
                            </button>
                            <h1>今天吃什麼</h1>
                            <h2>Q2:你像什麼動物</h2>
                            <input  @click="showList" type="text" v-model="selectedOption" class="myOptions">
                            <img class="whatToEat_q_arrow" @click="showList" src="./img/icon/icon_next_line.png" alt="">
                            <ul v-show="isOption" class="select_options" id="options">
                                <li v-for="favor in favors" @click='getOption(favor)'>{{favor}}</li>
                            </ul>
                            <div v-show="warn" class="questionWarn">
                                <img src="./img/index/warn.png" alt="">
                                <p> 請完成作答</p>
                            </div>
    
                            
                            <div class="btn">
                                <input  value="上一題" class="whatBtnPre btn_d btn_submit" @click="getPre">
                                <input  value="下一題" class="whatBtnNext btn_submit" @click="getNext">
                            </div>
                            
                        </form>
                    </div>
                `,
                data() {
                    return {
                        selectedOption: '',
                        favors: ['狗狗', '喵咪', '大象', '長頸鹿'],
                        isOption: false,
                        warn: false,
    
                    };
                },
                mounted() {
                    bus.$on('clear-input-emit', () => this.selectedOption = '');
                },
                methods: {
                    showList() {
                        this.isOption = !this.isOption;
                    },
                    getOption(favor) {
                        this.selectedOption = favor;
                        this.isOption = false;
                        this.$emit('answer-emit', favor);
                        this.warn = false;
                    },
                    getNext() {
                        if (this.selectedOption !== '') {
                            this.$emit('next-emit');
                        } else {
                            this.warn = true;
                        }
                    },
                    getPre() {
                        this.$emit('pre-emit');
                    },
                    closeForm() {
                        this.$emit('close-emit');
                        bus.$emit('clear-input-emit');
                        this.warn = false;
                    }
                },
            });
            Vue.component('popup-3', {
                props: [''],
                template: `
                    <div class="popUps index_whatToEat_popup 3">
                        <form class="form whatToEat_q" action="">
                            <button type="button" class="whatToEatClose btn_close" @click='closeForm'>
                                <img src="./img/icon/icon_close_20.png" alt="">
                            </button>
                            <h1>今天吃什麼</h1>
                            <h2>Q3:你現在想去的國家</h2>
                            <input  @click="showList" type="text" v-model="selectedOption" class="myOptions">
                            <img class="whatToEat_q_arrow" @click="showList" src="./img/icon/icon_next_line.png" alt="">
                            <ul v-show="isOption" class="select_options" id="options">
                                <li v-for="country in countrys" @click='getOption(country)'>{{country}}</li>
                            </ul>
                            <div v-show="warn" class="questionWarn">
                                <img src="./img/index/warn.png" alt="">
                                <p> 請完成作答</p>
                            </div>
    
                            <div class="btn">
                                <input  value="上一題" class="whatBtnPre btn_d btn_submit" @click="getPre">
                                <input  value="下一題" class="whatBtnNext btn_submit" @click="getNext" >
                            </div>
                            
                        </form>
                    </div>
                `,
                data() {
                    return {
                        selectedOption: '',
                        countrys: ['日本', '義大利', '美國', '留在台灣'],
                        isOption: false,
                        warn: false,
                    };
                },
                mounted() {
                    bus.$on('clear-input-emit', () => this.selectedOption = '');
                },
                methods: {
                    showList() {
                        this.isOption = !this.isOption;
                    },
                    getOption(country) {
                        this.selectedOption = country;
                        this.isOption = false;
                        this.$emit('answer-emit', country);
                        this.warn = false;
                    },
                    getNext() {
                        if (this.selectedOption !== '') {
                            this.$emit('next-emit');
                        } else {
                            this.warn = true;
                        }
                    },
                    getPre() {
                        this.$emit('pre-emit');
                    },
                    closeForm() {
                        this.$emit('close-emit');
                        bus.$emit('clear-input-emit');
                        this.warn = false;
                    }
    
                },
            });
            Vue.component('popup-4', {
                props: [],
                template: `
                    <div class="popUps index_whatToEat_popup 4">
                        <form class="form whatToEat_q" action="">
                            <button type="button" class="whatToEatClose btn_close" @click='closeForm'>
                                <img src="./img/icon/icon_close_20.png" alt="">
                            </button>
                            <h1>今天吃什麼</h1>
                            <h2>Q4:你的感情狀態</h2>
                            <input  @click="showList" type="text" v-model="selectedOption" class="myOptions">
                            <img class="whatToEat_q_arrow" @click="showList" src="./img/icon/icon_next_line.png" alt="">
                            <ul v-show="isOption" class="select_options" id="options">
                                <li v-for="feeling in emotion" @click='getOption(feeling)'>{{feeling}}</li>
                            </ul>
                            <div v-show="warn" class="questionWarn">
                                <img src="./img/index/warn.png" alt="">
                                <p> 請完成作答</p>
                            </div>
    
                            <div class="buttonArea">
                                <input  value="上一題" class="whatBtnPre btn_d btn_submit"  @click="getPre">
                                <input  value="看結果" class="whatBtnNext btn_d btn_submit" @click="getFood">
                            </div>
                            
                        </form>
                    </div>
                `,
                data() {
                    return {
                        selectedOption: '',
                        emotion: ['曖昧讓人受盡委屈', '孤獨萬歲', '失戀無罪', '戀愛i-n-g'],
                        isOption: false,
                        warn: false,
    
                    };
                },
                methods: {
                    showList() {
                        this.isOption = !this.isOption;
                    },
                    getOption(feeling) {
                        this.selectedOption = feeling;
                        this.isOption = false;
                        this.$emit('answer-emit', feeling);
                        this.warn = false;
                    },
    
                    getPre() {
                        this.$emit('pre-emit');
                    },
                    getFood() {
                        if (this.selectedOption !== '') {
                            this.$emit('next-emit');
                            this.$emit('get-food-emit');
                            bus.$emit('clear-input-emit')
    
                        } else {
                            this.warn = true;
                        }
    
    
                    },
                    closeForm() {
                        this.$emit('close-emit');
                        bus.$emit('clear-input-emit');
                        this.warn = false;
                    }
    
                },
            });
            Vue.component('popup-5', {
                props: ['food'],
                template: `
                    <div class="popUps index_whatToEat_popup 5">
                        <form class="form whatToEat_q" action="">
                            <button type="button" class="whatToEatClose btn_close" @click='closeForm'>
                                <img src="./img/icon/icon_close_20.png" alt="">
                            </button>
                            <h1>今天吃什麼</h1>
                            <h2>適合你的食物是</h2>
                            <input type="text" v-model="food" class="myOptions">
                            <div class="whatBtn buttonArea">
                                <input  value="再一次" class="whatBtnAgain btn_d btn_submit" @click="getAgain" >
                                <input  value="哪裡有" class=" getWhatBtn btn_d btn_submit"  @click="getStores">
                            </div>
                        </form>
                    </div>
                `,
                data() {
                    return {
    
                    };
                },
                methods: {
    
                    getAgain() {
                        this.$emit('again-emit');
                        bus.$emit('clear-input-emit')
    
                    },
                    closeForm() {
                        this.$emit('close-emit');
                        bus.$emit('clear-input-emit')
    
                    },
                    getStores() {
                        this.$emit('store-emit');
                        this.$emit('close-emit');
                    }
    
                },
            });
    
            Vue.component('location', {
                props: ['address'],
                template: `
                <p class="sectionIconInf">地址: {{address}}</p>
                `,
                data() {
                    return {
                    };
                },
                mounted() {
                },
                methods: {
                    // getInf(){
                    //     this.$emit('storeinf-emit');
                    // },
                },
            });
            Vue.component('station', {
                props: ['station'],
                template: `
                <p class="sectionIconInf">捷運站: {{station}}</p>
                `,
            });
            Vue.component('phone', {
                props: ['phone',],
                template: `
                <p class="sectionIconInf">電話: {{phone}}</p>
                `,
            });
            Vue.component('price', {
                props: ['price'],
                template: `
                <p class="sectionIconInf">平均消費: {{price}}</p>
                `,
            });
            //search
            new Vue({
                el: '#app_index',
                data: {
                    choices: [],//whatToEat答案
                    whatToEat: '',
                    isSearchBoard: false,
                    isWhatToEat: true,
                    isShowLine: false,
                    mrtLine: ['板南線', '淡水信義線', '松山新店線', '文湖線', '中和新蘆線'],
                    searchLine: '',
                    findFood: '',
                    searchTags: '',
                    isShowTag: false,
                    tags: ['日式', '韓式', '美式', '義式', '台式', '法式', '中式', '夜市', '商業午餐', '早午餐', '下午茶', '銅板美食', '簡餐', '聚餐', '餐酒館', '咖啡', '甜點', '麵食', '鹽酥雞', '雞排', '咖哩', '火鍋', '牛排', '拉麵', '鐵板燒','義大利麵'],
                    isTyped: false,
                    content: '',//question compoment
                    isSearchStores: false,
                    isStoreInf: false,
                    stores: [],//ajax
                    isSearchNothing: false,
                    isSearchReport: false,
                    heartGrayscale: 1,
                    warnOpacity: 0.5,
                    coupon: '領取優惠',
                    report: '',
                    inf: '',
                    infoOpacity: 1,
                    storeDetail: null,
                    member_id:null,
                    couponContent:'EaT起來85折券',
                },
                methods: {
                    //whatToEat
                    nextQ() {
                        this.content = String(parseInt(this.content) + 1);
                    },
                    preQ() {
                        this.content = String(parseInt(this.content) - 1);
                    },
                    answerQ(selected) {
                        let index = parseInt(this.content) - 1;
                        this.choices[index] = selected;
                    },
                    getFoodQ() {
                        this.choices[0] = this.choices[0][0];
                        switch (this.choices[2]) {
                            case '義大利':
                                this.choices[2] = '義式';
                                this.whatToEat = '義大利麵';
                                break;
                            case '美國':
                                this.choices[2] = '美式';
                                this.whatToEat = '牛排';
                                break;
                            case '留在台灣':
                                this.choices[2] = '台式';
                                this.whatToEat = '雞排';
                                break;
                            case '日本':
                                this.choices[2] = '日式';
                                this.whatToEat = '咖哩';
                                break;
                        }
                        
                    },
                    closeQ() {
                        this.content = '';
                        this.choices = ['', '', '', ''];
                    },
                    againQ() {
                        this.content = '1';
                        this.choices = ['', '', '', ''];
                    },
    
                    //search
                    closeSearch(number) {
                        if (number == 1) {
                            this.isSearchBoard = false;
                            this.searchLine = '';
                            this.findFood = '';
                            this.searchTags = '';
                            this.isSearchNothing = false;
                        } else if (number == 2) {
                            this.isSearchStores = false;
                            this.findFood = '';
    
                        } else if (number == 3) {
                            this.isStoreInf = false;
                            this.findFood = '';
                        } else if (number == 4) {
                            this.isShowTag = false;
                        } else if (number == 5) {
                            this.isSearchReport = false;
                            this.warnOpacity = 0.5;
                        }
    
                    },
                    show() {
                        this.optionList = !this.optionList;
                    },
                    closeSearchBoard() {
                        if (this.content = 1) {
                            this.isSearchBoard = false;
                        }
                    },
                    //打開搜尋彈窗
                    searchIcon() {
                        this.isSearchBoard = !this.isSearchBoard;
                        this.isSearchStores = false;
                        this.isStoreInf = false;
                        this.content = "";
                    },
                    //捷運線選單
    
                    showLine() {
                        this.isShowLine = !this.isShowLine;
                    },
                    myline(line) {
                        this.searchLine = line;
                        this.isShowLine = false;
                        this.isSearchNothing = false;
                    },
                    myTag(tag) {
                        this.searchTags = tag;
                        this.isShowTag = false;
                    },
                    showTag(number) {
                        if (number == 3 && this.findFood == '') {
                            this.isShowTag = !this.isShowTag;
                            this.isSearchNothing = false;
                        }
                        if (number == 1) {
                            this.searchTags = '';
                            this.isSearchNothing = false;
                        }
                    },
                    getMemberID(){
                        var id = this;
                            $.ajax({
                                method: "POST",
                                url: "./php/Frontend/API/LoginCheck.php",
                                data: {
                                },
                                dataType: "json",
                                success: function (response) {
                                    // alert(response);
                                    id.member_id = response;
                                },
                                error: function (exception) {
                                    // alert("發生錯誤: " + exception.status);
                                }
                            });
        
                    },
                    searchFood() {
                        if (this.findFood != '' || this.searchTags != '' || this.searchLine != '') {
                            let data1 = this.findFood;
                            let data2 = this.searchLine;
                            let data3 = this.searchTags;
    
    
                            this.searchLine = '';
                            this.findFood = '';
                            this.searchTags = '';
                            this.isSearchBoard = false;
                            this.isSearchStores = true;
                            this.isSearchNothing = false;
    
                            var self = this;
                            $.ajax({
                                method: "POST",
                                url: "./php/Frontend/API/search.php",
                                data: {
                                    //php變數
                                    searchItem: data1,
                                    line_name: data2,
                                    tag_name: data3,
    
                                },
                                dataType: "json",
                                success: function (response) {
                                    // alert(response);
                                    self.stores = response;
                                    
                                },
                                error: function (exception) {
                                    alert("發生錯誤: " + exception.status);
                                }
                            });
                        this.member_id=this.getMemberID();
                        } else {
                            this.isSearchNothing = true;
                        }
    
                    },
                    showStores() {
                        var where = this;
                        $.ajax({
                            method: "POST",
                            url: "./php/Frontend/API/whatToEat.php",
                            data: {
                                whatToEatColor: where.choices[0],
                                whatToEatCountry: where.choices[2],
                                whatToEat:where.whatToEat,
                            },
                            dataType: "json",
                            success: function (response) {
                                   where.stores=response
                            },
                            error: function (exception) {
                                alert("數據載入失敗: " + exception.status);
                            }
                        });
                        this.isSearchStores = true;
    
                    },
                    finalStoreInf(store) {
                        var self2 = this;
                        $.ajax({
                            method: "POST",
                            url: "./php/Frontend/API/checkFavorite.php",
                            data: {
                                store_id: store.store_id,
                                member_id: self2.member_id
                            },
                            dataType: "text",
                            success: function (response) {
                                if(response=="") {
                                    //沒回傳值就是沒登入或沒收藏
                                    self2.heartGrayscale = 1;
                                } 
                                else{
                                    //有回傳值就是有登入且有收藏
                                    self2.heartGrayscale = 0;
                                }
                            },
                            error: function (exception) {
                                alert("數據載入失敗: " + exception.status);
                            }
                        });
                        $.ajax({
                                method: "POST",
                                url: "./php/Frontend/API/checkCoupon.php",
                                data: {
                                    memberID:self2.member_id,
                                },
                                dataType: "text",
                                success: function (response) {
                                    if (response == "") {
                                        self2.coupon='領取優惠';
                                    }
                                    else{
                                        self2.coupon='領取過了';
                                    }
                                },
                                error: function (exception) {
                                    alert("數據載入失敗: " + exception.status);
                                }
                            });
    
                        this.isSearchStores = false;
                        this.isStoreInf = true;
                        this.storeDetail = store;
                        this.$nextTick(() => {
                            slick();
                        })
    
                    },
                    searchSomething() {
                        if (this.findFood != '' && this.findFood != '請輸入食物 站別 店名') {
                            let data1 = this.findFood;
                            let data2 = this.searchLine;
                            let data3 = this.searchTags;
                            var self = this;
                            // alert(data1);
                            $.ajax({
                                method: "POST",
                                url: "./php/Frontend/API/search.php",
                                data: {
                                    //php變數
                                    searchItem: data1,
                                    line_name: data2,
                                    tag_name: data3,
    
                                },
                                dataType: "json",
                                success: function (response) {
                                    // alert(response);
    
                                    self.stores = response;
                                },
                                error: function (exception) {
                                    alert("發生錯誤: " + exception.status);
                                }
                            });
    
                            this.isStoreInf = false;
                            this.isSearchStores = true;
                            this.findFood = '';
    
    
                        } else {
                            this.findFood = '請輸入食物 站別 店名';
                        }
    
                    },
    
                    getStoreReported() {
                        this.isSearchReport = true;
                        this.warnOpacity = 1;
                    },
                    sendReport() {
                        console.log(this.report);
                        this.report = '';
                        this.isSearchReport = false;
                        this.warnOpacity = 0.5;
                    },
                    getCoupon() {
                            var get =this;
                            let couponContent = this.couponContent;
                            let couponMemberID = this.member_id;
                            $.ajax({
                                method: "POST",
                                url: "./php/Frontend/API/getCoupon.php",
                                data: {
                                    coupon:couponContent,
                                    memberID:couponMemberID,
                                },
                                dataType: "text",
                                success: function (response) {
                                    if (response == "") {
                                        get.coupon='領取過';
                                    }else{
                                        alert("今天已領取");
                                    }
                                },
                                error: function (exception) {
                                    alert("數據載入失敗: " + exception.status);
                                }
                            });                    
                        
                    },
                    toCollect() {
                        if (this.heartGrayscale == 0) {
                            this.heartGrayscale = 1;
                            // console.log('{{this.store}}');
                            let storeId = this.storeDetail.store_id;
                            $.ajax({
                                method: "POST",
                                url: "./php/Frontend/API/RemoveFavorite.php",
                                data: {
                                    favorite: storeId
                                },
                                dataType: "json",
                            });
                            alert("將從我的最愛移除");
                        } else {
                            // console.log('{{this.store}}');
                            this.heartGrayscale = 0;
                            let storeId = this.storeDetail.store_id;
                            $.ajax({
                                method: "POST",
                                url: "./php/Frontend/API/AddFavorite.php",
                                data: {
                                    //php變數
                                    favorite: storeId
                                },
                                dataType: "json",
                            });
                            alert("新增到我的最愛");
                        }
                    },
                    loginCheck(number) {
                        if (number == 1) {
                            var like = this;
                            $.ajax({
                                method: "POST",
                                url: "./php/Frontend/API/LoginCheck.php",
                                data: {},
                                dataType: "text",
                                success: function (response) {
                                    if (response == "") {
                                        //尚未登入->前往Login.php
                                        alert('請先登入，將前往登入頁');
                                        location.href = 'login_member.html';
                                    } else {
                                        like.toCollect();
                                    }
                                },
                                error: function (exception) {
                                    alert("數據載入失敗: " + exception.status);
                                }
                            });
                        } else if (number == 2) {
                            var coupon =this;
                            $.ajax({
                                method: "POST",
                                url: "./php/Frontend/API/LoginCheck.php",
                                data: {},
                                dataType: "text",
                                success: function (response) {
                                    if (response == "") {
                                        //尚未登入->前往Login.php
                                        alert('請先登入，將前往登入頁');
                                        location.href = 'login_member.html';
                                    } else {
                                        coupon.getCoupon();
                                    }
                                },
                                error: function (exception) {
                                    alert("數據載入失敗: " + exception.status);
                                }
                            });
                        }
                    },
                    getDarkStars(lightStars) {
                        if (lightStars == null) {
                            return 5;
                        } else {
                            return 5 - lightStars;
                        }
                    },
    
    
    
    
                },
                computed: {
                    findFoodClass() {
                        return {
                            noText: this.findFood.length === 0,
                        }
                    },
                    searchLineClass() {
                        return {
                            noText: this.searchLine.length === 0,
                        }
                    },
                    searchTagsClass() {
                        return {
                            noText: this.searchTags.length === 0,
                        }
                    },
                    collectionClass() {
                        //light =>0 dark=>1
    
                        return {
                            filter: `grayscale(${this.heartGrayscale})`,
                        }
                    },
                    signOpacity() {
                        return {
                            filter: `opacity(${this.warnOpacity})`,
                        }
                    },
                    storeInfOpacity() {
                        return {
                            filter: `opacity(${this.infoOpacity})`,
                        }
                    },
                },
    
            });
            function slick() {
                $('.slider-for').slick({
                    slidesToShow: 1,
                    slidesToScroll: 1,
                    arrows: false,
                    fade: true,
                    asNavFor: '.slider-nav',
                });
    
                $('.slider-nav').slick({
                    slidesToShow: 4,
                    slidesToScroll: 1,
                    arrows: false,
                    asNavFor: '.slider-for',
                    focusOnSelect: true,
                });
            }
    
    
    
    
        </script>
    </body>
    
    </html>